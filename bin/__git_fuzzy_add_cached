#!/usr/bin/env ruby

require "shellwords"

def git_cached_files
  file_list = `git diff --cached --name-only`.split("\n")
  file_list
end

def match(pattern)
  files = git_cached_files

  files.select! { |f| f =~ pattern }
  files.map { |f| Shellwords.escape f }
end

exit 1 unless ARGV.count == 1

puts match(/#{ARGV[0].gsub(/\//, "\/")}/)
